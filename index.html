<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–ï–ì–≠ MiniApp</title>

<style>
*{
  box-sizing:border-box;
  margin:0;
  padding:0;
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
}

body{
  background:#000;
  color:#fff;
  display:flex;
  flex-direction:column;
  height:100vh;
  overflow:hidden;
}

/* ====== TOP ====== */

.top{
  position:relative;
  display:flex;
  justify-content:center;
  padding:14px 0;
}

.ege-btn{
  padding:8px 28px;
  border-radius:30px;
  background:#1c1c1e;
  border:2px solid #2AABEE;
  color:#2AABEE;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

.ege-btn:active{
  transform:scale(.96);
}

.dropdown{
  position:absolute;
  top:60px;
  background:#1c1c1e;
  border-radius:16px;
  overflow:hidden;
  width:170px;
  transform:translateY(-10px);
  opacity:0;
  pointer-events:none;
  transition:.25s;
  border:1px solid #2a2a2c;
}

.dropdown.show{
  transform:translateY(0);
  opacity:1;
  pointer-events:auto;
}

.dropdown-item{
  padding:12px;
  text-align:center;
  cursor:pointer;
  transition:.2s;
}

.dropdown-item:hover{
  background:#2AABEE;
  color:#000;
}

/* ===== WORD AREA ===== */

.word{
  flex:1;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-wrap:nowrap;
  padding:0 10px;
  overflow:hidden;
  text-align:center;
}

.letter{
  display:inline-block;
  padding:4px;
  margin:2px;
  border-radius:50%;
  cursor:pointer;
  user-select:none;
  transition:.2s;
}

.wrong{
  background:#ff453a;
  box-shadow:0 0 8px #ff453a;
}

.message{
  text-align:center;
  min-height:28px;
  padding:6px;
  font-size:.95rem;
  color:#2AABEE;
}

/* ===== BOTTOM ===== */

.bottom{
  padding:12px;
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:center;
}

.score{
  min-width:48px;
  height:48px;
  background:#1c1c1e;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:1.2rem;
  border:2px solid #333;
  color:#2AABEE;
}

.input-box{
  flex:1;
  max-width:200px;
}

.input-box input{
  width:100%;
  padding:12px;
  border-radius:35px;
  border:none;
  background:#1c1c1e;
  color:white;
  text-align:center;
  font-size:1rem;
}

.next{
  width:48px;
  height:48px;
  border-radius:50%;
  background:#1c1c1e;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:22px;
  border:2px solid #333;
  color:#2AABEE;
  cursor:pointer;
}

@media(max-width:360px){
  .score,.next{
    width:44px;
    height:44px;
  }
}
</style>
</head>
<body>

<div class="top">
  <div class="ege-btn" id="egeBtn">üéì –ï–ì–≠</div>
  <div class="dropdown" id="dropdown">
    <div class="dropdown-item" data-mode="stress">–£–¥–∞—Ä–µ–Ω–∏—è</div>
    <div class="dropdown-item" data-mode="roots">–ö–æ—Ä–Ω–∏</div>
  </div>
</div>

<div class="word" id="word"></div>
<div class="message" id="message"></div>

<div class="bottom">
  <div class="score" id="score">0</div>
  <div class="input-box">
    <input type="text" id="answerInput" inputmode="numeric" placeholder="–ù–æ–º–µ—Ä –±—É–∫–≤—ã">
  </div>
  <div class="next" id="nextBtn">‚Üª</div>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>

// ===== Telegram =====
const tg = window.Telegram.WebApp;
tg.expand();
tg.ready();

// ===== DATA =====

const banks = {
  stress: ["–∞—ç—Ä–æ–ø–û—Ä—Ç—ã", "–±–ê–Ω—Ç—ã", "–±–û—Ä–æ–¥—É", "–±—É—Ö–≥–ê–ª—Ç–µ—Ä–æ–≤", "–≤–µ—Ä–æ–∏—Å–ø–æ–≤–ï–¥–∞–Ω–∏–µ",
        "–≤–æ–¥–æ–ø—Ä–æ–≤–û–¥", "–≥–∞–∑–æ–ø—Ä–æ–≤–û–¥", "–≥—Ä–∞–∂–¥–ê–Ω—Å—Ç–≤–æ", "–¥–µ—Ñ–ò—Å", "–¥–µ—à–µ–≤–ò–∑–Ω–∞",
        "–¥–∏—Å–ø–∞–Ω—Å–ï—Ä", "–¥–æ–≥–æ–≤–æ—Ä√ã–Ω–Ω–æ—Å—Ç—å", "–¥–æ–∫—É–º–ï–Ω—Ç", "–¥–æ—Å–£–≥", "–µ—Ä–µ—Ç–ò–∫",
        "–∂–∞–ª—é–∑–ò", "–∑–Ω–ê—á–∏–º–æ—Å—Ç—å", "–ò–∫—Å—ã", "–∫–∞—Ç–∞–ª–û–≥", "–∫–≤–∞—Ä—Ç–ê–ª",
        "–∫–∏–ª–æ–º–ï—Ç—Ä", "–∫–û–Ω—É—Å–æ–≤", "–∫–æ—Ä–´—Å—Ç—å", "–∫—Ä–ê–Ω—ã", "–∫—Ä–µ–º–ï–Ω—å",
        "–∫—Ä–µ–º–Ω–Ø", "–ª–ï–∫—Ç–æ—Ä–æ–≤", "–ª–û–∫—Ç—è", "–ª—ã–∂–Ω–Ø", "–º–ï—Å—Ç–Ω–æ—Å—Ç–µ–π",
        "–Ω–∞–º–ï—Ä–µ–Ω–∏–µ", "–Ω–ï–¥—Ä—É–≥", "–Ω–µ–¥–£–≥", "–Ω–µ–∫—Ä–æ–ª–û–≥", "–Ω–ï–Ω–∞–≤–∏—Å—Ç—å",
        "–Ω–µ—Ñ—Ç–µ–ø—Ä–æ–≤–û–¥", "–Ω–æ–≤–æ—Å—Ç–ï–π", "–Ω–û–≥—Ç—è", "–û—Ç–∑—ã–≤ (–æ –∫–Ω–∏–≥–µ)", "–æ—Ç–∑–´–≤ (–ø–æ—Å–ª–∞ –∏–∑ —Å—Ç—Ä–∞–Ω—ã)",
        "–û—Ç—Ä–æ—á–µ—Å—Ç–≤–æ", "–ø–∞—Ä—Ç–ï—Ä", "–ø–æ—Ä—Ç—Ñ–ï–ª—å", "–ø—Ä–∏–¥–ê–Ω–æ–µ", "–ø—Ä–∏–∑–´–≤",
        "—Å–≤–Å–∫–ª–∞", "—Å–∏—Ä–û—Ç—ã", "—Å–æ–∑–´–≤", "—Å–æ—Å—Ä–µ–¥–æ—Ç–û—á–µ–Ω–∏–µ", "—Å—Ä–ï–¥—Å—Ç–≤–∞",
        "—Å—Ç–ê—Ç—É—è", "—Å—Ç–æ–ª–Ø—Ä", "—Ç–∞–º–û–∂–Ω—è", "—Ç–û—Ä—Ç—ã", "—Ç–£—Ñ–ª—è",
        "—Ü–µ–º–ï–Ω—Ç", "—Ü–ï–Ω—Ç–Ω–µ—Ä", "—Ü–µ–ø–û—á–∫–∞", "—à–ê—Ä—Ñ—ã", "—à–æ—Ñ–Å—Ä",
        "—ç–∫—Å–ø–ï—Ä—Ç", "–≤–µ—Ä–Ω–ê", "–∑–Ω–ê—á–∏–º—ã–π", "–∫—Ä–∞—Å–ò–≤–µ–µ", "–∫–£—Ö–æ–Ω–Ω—ã–π",
        "–ª–æ–≤–∫–ê", "–º–æ–∑–∞–ò—á–Ω—ã–π", "–æ–ø—Ç–û–≤—ã–π", "–ø—Ä–æ–∑–æ—Ä–ª–ò–≤—ã–π", "–ø—Ä–æ–∑–æ—Ä–ª–ò–≤–∞",
        "—Å–ª–ò–≤–æ–≤—ã–π", "–±—Ä–∞–ª–ê—Å—å", "–≤–∑—è–ª–ê", "–≤–∑—è–ª–ê—Å—å", "–≤–ª–∏–ª–ê—Å—å",
        "–≤–æ—Ä–≤–∞–ª–ê—Å—å", "–≤–æ—Å–ø—Ä–∏–Ω–Ø—Ç—å", "–≤–æ—Å—Å–æ–∑–¥–∞–ª–ê", "–≤—Ä—É—á–ò—Ç", "–≥–Ω–∞–ª–ê",
        "–≥–Ω–∞–ª–ê—Å—å", "–¥–æ–±—Ä–∞–ª–ê", "–¥–æ–±—Ä–∞–ª–ê—Å—å", "–¥–æ–∂–¥–∞–ª–ê—Å—å", "–¥–æ–∑–≤–æ–Ω–ò—Ç—Å—è",
        "–¥–æ–∑–ò—Ä–æ–≤–∞—Ç—å", "–∂–¥–∞–ª–ê", "–∑–∞–∫–£–ø–æ—Ä–∏—Ç—å", "–∑–∞–Ω–Ø—Ç—å", "–∑–∞–ø–µ—Ä–ª–ê",
        "–∑–∞–ø–ª–æ–º–±–∏—Ä–æ–≤–ê—Ç—å", "–∑–∞—â–µ–º–ò—Ç", "–∑–≤–∞–ª–ê", "–∑–≤–æ–Ω–ò—Ç", "–∫–ê—à–ª—è–Ω—É—Ç—å",
        "–∫–ª–ê–ª–∞", "–∫–ª–ï–∏—Ç—å", "–∫—Ä–∞–ª–ê—Å—å", "–∫—Ä–æ–≤–æ—Ç–æ—á–ò—Ç—å", "–ª–≥–∞–ª–ê",
        "–ª–∏–ª–ê", "–ª–∏–ª–ê—Å—å", "–Ω–∞–¥–µ–ª–ò—Ç", "–Ω–∞–¥–æ—Ä–≤–∞–ª–ê—Å—å", "–Ω–∞–∑–≤–∞–ª–ê—Å—å",
        "–Ω–∞–∫—Ä–µ–Ω–ò—Ç—Å—è", "–Ω–∞–ª–∏–ª–ê", "–Ω–∞—Ä–≤–∞–ª–ê", "–Ω–∞—á–ê—Ç—å", "–Ω–ê—á–∞–ª",
        "–Ω–∞—á–∞–ª–ê", "–Ω–ê—á–∞–ª–∏", "–æ–±–∑–≤–æ–Ω–ò—Ç", "–æ–±–ª–µ–≥—á–ò—Ç—å", "–æ–±–ª–∏–ª–ê—Å—å",
        "–æ–±–Ω—è–ª–ê—Å—å", "–æ–±–æ–≥–Ω–∞–ª–ê", "–æ–±–æ–¥—Ä–∞–ª–ê", "–æ–±–æ–¥—Ä–ò—Ç—å", "–æ–±–æ–¥—Ä–ò—Ç—å—Å—è",
        "–æ–±–æ–¥—Ä–ò—Ç—Å—è", "–æ–±–æ—Å—Ç—Ä–ò—Ç—å", "–æ–¥–æ–ª–∂–ò—Ç—å", "–æ–¥–æ–ª–∂–ò—Ç", "–æ–∑–ª–û–±–∏—Ç—å",
        "–æ–∫–ª–ï–∏—Ç—å", "–æ–∫—Ä—É–∂–ò—Ç", "–æ–ø–û—à–ª–∏—Ç—å", "–æ—Å–≤–ï–¥–æ–º–∏—Ç—å—Å—è", "–æ—Å–≤–ï–¥–æ–º–∏—Ç—Å—è",
        "–æ—Ç–±—ã–ª–ê", "–æ—Ç–¥–∞–ª–ê", "–æ—Ç–∫–£–ø–æ—Ä–∏—Ç—å", "–æ—Ç–æ–∑–≤–∞–ª–ê", "–æ—Ç–æ–∑–≤–∞–ª–ê—Å—å",
        "–ø–µ—Ä–µ–∑–≤–æ–Ω–ò—Ç", "–ø–µ—Ä–µ–ª–∏–ª–ê", "–ø–ª–æ–¥–æ–Ω–æ—Å–ò—Ç—å", "–ø–ª–æ–º–±–∏—Ä–æ–≤–ê—Ç—å", "–ø–æ–≤—Ç–æ—Ä–ò—Ç",
        "–ø–æ–∑–≤–∞–ª–ê", "–ø–æ–∑–≤–æ–Ω–ò—Ç", "–ø–æ–ª–∏–ª–ê", "–ø–æ–ª–æ–∂–ò—Ç—å", "–ø–æ–ª–æ–∂–ò–ª",
        "–ø–æ–Ω–Ø—Ç—å", "–ø–æ–Ω—è–ª–ê", "–ø–æ—Å–ª–ê–ª–∞", "–ø—Ä–∏–±–´—Ç—å", "–ø—Ä–ò–±—ã–ª",
        "–ø—Ä–∏–±—ã–ª–ê", "–ø—Ä–ò–±—ã–ª–∏", "–ø—Ä–∏–Ω–Ø—Ç—å", "–ø—Ä–ò–Ω—è–ª", "–ø—Ä–∏–Ω—è–ª–ê",
        "–ø—Ä–ò–Ω—è–ª–∏", "—Ä–≤–∞–ª–ê", "—Å–≤–µ—Ä–ª–ò—Ç", "—Å–Ω—è–ª–ê", "—Å–æ–∑–¥–∞–ª–ê",
        "—Å–æ—Ä–≤–∞–ª–ê", "—É–±—Ä–∞–ª–ê", "—É–≥–ª—É–±–ò—Ç—å", "—É–∫—Ä–µ–ø–ò—Ç", "—á–ï—Ä–ø–∞—Ç—å",
        "—â–µ–º–ò—Ç", "—â–Å–ª–∫–∞—Ç—å", "–¥–æ–≤–µ–∑–Å–Ω–Ω—ã–π", "–∑–ê–≥–Ω—É—Ç—ã–π", "–∑–ê–Ω—è—Ç—ã–π",
        "–∑–∞–Ω—è—Ç–ê", "–∑–ê–ø–µ—Ä—Ç—ã–π", "–∑–∞—Å–µ–ª–Å–Ω–Ω—ã–π", "–∑–∞—Å–µ–ª–µ–Ω–ê", "–∫—Ä–æ–≤–æ—Ç–æ—á–ê—â–∏–π",
        "–Ω–∞–∂–ò–≤—à–∏–π", "–Ω–∞–ª–ò–≤—à–∏–π", "–Ω–∞–Ω–Ø–≤—à–∏–π—Å—è", "–Ω–∞—á–ê–≤—à–∏–π", "–Ω–ê—á–∞—Ç—ã–π",
        "–Ω–∏–∑–≤–µ–¥–Å–Ω–Ω—ã–π", "–æ–±–ª–µ–≥—á–Å–Ω–Ω—ã–π", "–æ–±–æ–¥—Ä–Å–Ω–Ω—ã–π", "–æ–±–æ—Å—Ç—Ä–Å–Ω–Ω—ã–π", "–æ—Ç–∫–ª—é—á–Å–Ω–Ω—ã–π",
        "–ø–æ–≤—Ç–æ—Ä–Å–Ω–Ω—ã–π", "–ø–æ–¥–µ–ª–Å–Ω–Ω—ã–π", "–ø–æ–Ω–Ø–≤—à–∏–π", "–ø—Ä–ò–Ω—è—Ç—ã–π", "–ø—Ä–∏–Ω—è—Ç–ê",
        "–ø—Ä–∏—Ä—É—á–Å–Ω–Ω—ã–π", "–ø—Ä–æ–∂–ò–≤—à–∏–π", "—Å–Ω—è—Ç–ê", "—Å–û–≥–Ω—É—Ç—ã–π", "—É–≥–ª—É–±–ª–Å–Ω–Ω—ã–π",
        "–∑–∞–∫–£–ø–æ—Ä–∏–≤", "–Ω–∞—á–ê–≤", "–Ω–∞—á–ê–≤—à–∏—Å—å", "–æ—Ç–¥–ê–≤", "–ø–æ–Ω–Ø–≤",
        "–ø—Ä–∏–±–´–≤", "—Å–æ–∑–¥–ê–≤", "–≤–û–≤—Ä–µ–º—è", "–¥–û–≤–µ—Ä—Ö—É", "–¥–û–Ω–∏–∑—É",
        "–¥–û—Å—É—Ö–∞", "–∑–ê—Å–≤–µ—Ç–ª–æ", "–∫—Ä–∞—Å–ò–≤–µ–µ", "–Ω–∞–¥–û–ª–≥–æ", "–Ω–µ–Ω–∞–¥–û–ª–≥–æ"],
  roots: ["—Ä–∞—Å—Ç/—Ä–æ—Å","–±–µ—Ä/–±–∏—Ä","–∫–∞—Å/–∫–æ—Å"]
};

let currentMode = "stress";
let currentItem;
let score = 0;

// ===== DOM =====

const wordDiv = document.getElementById("word");
const messageDiv = document.getElementById("message");
const scoreEl = document.getElementById("score");
const input = document.getElementById("answerInput");
const nextBtn = document.getElementById("nextBtn");
const egeBtn = document.getElementById("egeBtn");
const dropdown = document.getElementById("dropdown");

// ===== MENU =====

egeBtn.onclick = () => dropdown.classList.toggle("show");

document.querySelectorAll(".dropdown-item").forEach(item=>{
  item.onclick=()=>{
    setMode(item.dataset.mode);
    dropdown.classList.remove("show");
  }
});

document.addEventListener("click",(e)=>{
  if(!egeBtn.contains(e.target) && !dropdown.contains(e.target)){
    dropdown.classList.remove("show");
  }
});

// ===== MODE =====

function setMode(mode){
  currentMode = mode;
  score = 0;
  scoreEl.innerText = score;
  loadNew();
}

// ===== LOGIC =====

function parseStress(word){
  let stressIndex = 0;
  for(let i=0;i<word.length;i++){
    if(word[i]!==word[i].toLowerCase()){
      stressIndex = i;
    }
  }
  return {word:word,stress:stressIndex};
}

function showWord(item){
  wordDiv.innerHTML="";
  item.word.split("").forEach((ch,i)=>{
    const span=document.createElement("span");
    span.className="letter";
    span.innerText=ch.toUpperCase();
    span.onclick=()=>check(i);
    wordDiv.appendChild(span);
  });
  fitWord();
}

function fitWord(){
  const letters=document.querySelectorAll(".letter");
  if(!letters.length) return;
  let size = window.innerWidth/(letters.length+1);
  size=Math.min(Math.max(size*0.6,18),60);
  letters.forEach(l=>l.style.fontSize=size+"px");
}

function check(index){
  if(currentMode==="stress"){
    if(index===currentItem.stress){
      success();
    }else{
      fail();
      document.querySelectorAll(".letter")[currentItem.stress].classList.add("wrong");
    }
  }
}

function success(){
  score++;
  scoreEl.innerText=score;
  messageDiv.innerText="‚úÖ –í–µ—Ä–Ω–æ";
  setTimeout(loadNew,400);
}

function fail(){
  messageDiv.innerText="‚ùå –û—à–∏–±–∫–∞";
}

function loadNew(){
  messageDiv.innerText="";
  input.value="";
  input.focus();

  if(currentMode==="stress"){
    const raw = banks.stress[Math.floor(Math.random()*banks.stress.length)];
    currentItem = parseStress(raw);
    showWord(currentItem);
  }else{
    const raw = banks.roots[Math.floor(Math.random()*banks.roots.length)];
    currentItem = {word:raw};
    wordDiv.innerHTML="<div style='font-size:28px'>"+raw+"</div>";
  }
}

// ===== INPUT =====

input.addEventListener("keypress",e=>{
  if(e.key==="Enter" && currentMode==="stress"){
    const val=parseInt(input.value)-1;
    if(!isNaN(val)) check(val);
    input.value="";
  }
});

nextBtn.onclick=loadNew;
window.addEventListener("resize",fitWord);

// —Å—Ç–∞—Ä—Ç
loadNew();

</script>
</body>
</html>
